<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Time Series Analysis with R</title>
  <meta name="description" content="Applied Time Series Analysis with R">
  <meta name="generator" content="bookdown 0.7.10 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Time Series Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="SMAC-Group/app_ts" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Time Series Analysis with R" />
  
  
  

<meta name="author" content="Stéphane Guerrier, Roberto Molinari and Haotian Xu">


<meta name="date" content="2018-08-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="fzb.html">
<link rel="next" href="basicmodels.html">
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="about-this-book.html"><a href="about-this-book.html"><i class="fa fa-check"></i><b>1.1</b> About This Book</a></li>
<li class="chapter" data-level="1.2" data-path="bibliographic-note.html"><a href="bibliographic-note.html"><i class="fa fa-check"></i><b>1.2</b> Bibliographic Note</a></li>
<li class="chapter" data-level="1.3" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>1.3</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.4" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>1.4</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-elements-of-time-series.html"><a href="basic-elements-of-time-series.html"><i class="fa fa-check"></i><b>2</b> Basic Elements of Time Series</a><ul>
<li class="chapter" data-level="2.1" data-path="fzb.html"><a href="fzb.html"><i class="fa fa-check"></i><b>2.1</b> fzb 😱</a></li>
<li class="chapter" data-level="2.2" data-path="the-wold-decomposition.html"><a href="the-wold-decomposition.html"><i class="fa fa-check"></i><b>2.2</b> The Wold Decomposition</a><ul>
<li class="chapter" data-level="2.2.1" data-path="the-wold-decomposition.html"><a href="the-wold-decomposition.html#the-deterministic-component-signal"><i class="fa fa-check"></i><b>2.2.1</b> The deterministic component (Signal)</a></li>
<li class="chapter" data-level="2.2.2" data-path="the-wold-decomposition.html"><a href="the-wold-decomposition.html#the-random-component-noise"><i class="fa fa-check"></i><b>2.2.2</b> The random component (Noise)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basicmodels.html"><a href="basicmodels.html"><i class="fa fa-check"></i><b>2.3</b> Modelling Time Series</a><ul>
<li class="chapter" data-level="2.3.1" data-path="basicmodels.html"><a href="basicmodels.html#dependence-within-time-series"><i class="fa fa-check"></i><b>2.3.1</b> Dependence within Time Series</a></li>
<li class="chapter" data-level="2.3.2" data-path="basicmodels.html"><a href="basicmodels.html#basic-time-series-models"><i class="fa fa-check"></i><b>2.3.2</b> Basic Time Series Models</a></li>
<li class="chapter" data-level="2.3.3" data-path="basicmodels.html"><a href="basicmodels.html#wn"><i class="fa fa-check"></i><b>2.3.3</b> White Noise</a></li>
<li class="chapter" data-level="2.3.4" data-path="basicmodels.html"><a href="basicmodels.html#rw"><i class="fa fa-check"></i><b>2.3.4</b> Random Walk</a></li>
<li class="chapter" data-level="2.3.5" data-path="basicmodels.html"><a href="basicmodels.html#ar1"><i class="fa fa-check"></i><b>2.3.5</b> First-Order Autoregressive Model</a></li>
<li class="chapter" data-level="2.3.6" data-path="basicmodels.html"><a href="basicmodels.html#ma1"><i class="fa fa-check"></i><b>2.3.6</b> Moving Average Process of Order 1</a></li>
<li class="chapter" data-level="2.3.7" data-path="basicmodels.html"><a href="basicmodels.html#drift"><i class="fa fa-check"></i><b>2.3.7</b> Linear Drift</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="lts.html"><a href="lts.html"><i class="fa fa-check"></i><b>2.4</b> Composite Stochastic Processes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="representations-of-time-series.html"><a href="representations-of-time-series.html"><i class="fa fa-check"></i><b>3</b> Representations of Time Series</a><ul>
<li class="chapter" data-level="3.1" data-path="the-autocorrelation-and-autocovariance-functions.html"><a href="the-autocorrelation-and-autocovariance-functions.html"><i class="fa fa-check"></i><b>3.1</b> The Autocorrelation and Autocovariance Functions</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-autocorrelation-and-autocovariance-functions.html"><a href="the-autocorrelation-and-autocovariance-functions.html#a-fundamental-representation"><i class="fa fa-check"></i><b>3.1.1</b> A Fundamental Representation</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-autocorrelation-and-autocovariance-functions.html"><a href="the-autocorrelation-and-autocovariance-functions.html#admissible-autocorrelation-functions"><i class="fa fa-check"></i><b>3.1.2</b> Admissible Autocorrelation Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="estimation-of-moments.html"><a href="estimation-of-moments.html"><i class="fa fa-check"></i><b>3.2</b> Estimation of Moments</a><ul>
<li class="chapter" data-level="3.2.1" data-path="estimation-of-moments.html"><a href="estimation-of-moments.html#estimation-of-the-mean-function"><i class="fa fa-check"></i><b>3.2.1</b> Estimation of the Mean Function</a></li>
<li class="chapter" data-level="3.2.2" data-path="estimation-of-moments.html"><a href="estimation-of-moments.html#sample-autocovariance-and-autocorrelation-functions"><i class="fa fa-check"></i><b>3.2.2</b> Sample Autocovariance and Autocorrelation Functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="estimation-of-moments.html"><a href="estimation-of-moments.html#robustness-issues"><i class="fa fa-check"></i><b>3.2.3</b> Robustness Issues</a></li>
<li class="chapter" data-level="3.2.4" data-path="estimation-of-moments.html"><a href="estimation-of-moments.html#sample-cross-covariance-and-cross-correlation-functions"><i class="fa fa-check"></i><b>3.2.4</b> Sample Cross-Covariance and Cross-Correlation Functions</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Time Series Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-wold-decomposition" class="section level2">
<h2><span class="header-section-number">2.2</span> The Wold Decomposition</h2>
<p>The previous discussion highlighted how a time series can be decomposed into a deterministic component and a random component. Leaving aside technical rigour, this characteristic of time series was put forward in Wold’s Decomposition Theorem who postulated that a time series <span class="math inline">\((Y_t)\)</span> (where <span class="math inline">\(t = 1,...,n\)</span> represents the time index) can be very generically represented as follows:</p>
<p><span class="math display">\[Y_t = D_t + W_t,\]</span></p>
<p>where <span class="math inline">\(D_t\)</span> represents the deterministic part (or <em>signal</em>) that can be modelled through the standard modelling techniques (e.g. linear regression) and <span class="math inline">\(W_t\)</span> that, restricting ourselves to a general class of processes, represents the random part (<em>noise</em>) that requires the analytical and modelling approaches that will be tackled in this book.</p>
<p>Typically, we have <span class="math inline">\(\mathbb{E}[Y_t] \neq 0\)</span> while <span class="math inline">\(\mathbb{E}[W_t] = 0\)</span> (although we may have
<span class="math inline">\(\mathbb{E}[W_t | W_{t-1}, ..., W_1] \neq 0\)</span>). Such models impose some parametric
structure which represents a convenient and flexible way of studying time series
as well as a means to evaluate <em>future</em> values of the series through forecasting.
As we will see, predicting future values is one of the main aspects of time
series analysis. However, making predictions is often a daunting task or as
famously stated by Nils Bohr:</p>
<blockquote>
<p>“<em>Prediction is very difficult, especially about the future.</em>”</p>
</blockquote>
<p>There are plenty of examples of predictions that turned out to be completely
erroneous. For example, three days before the 1929 crash, Irving Fisher,
Professor of Economics at Yale University, famously predicted:</p>
<blockquote>
<p>“<em>Stock prices have reached what looks like a permanently high plateau</em>”.</p>
</blockquote>
<p>Another example is given by Thomas Watson, president of IBM, who said in 1943:</p>
<blockquote>
<p>“<em>I think there is a world market for maybe five computers.</em>”</p>
</blockquote>
<p>Let us now briefly discuss the two components of a time series.</p>
<div id="the-deterministic-component-signal" class="section level3">
<h3><span class="header-section-number">2.2.1</span> The deterministic component (Signal)</h3>
<p>Before shifting our focus to the random component of time series, we will first just briefly underline the main features that should be taken into account for the deterministic component. The first feature that should be analysed is the <em>trend</em> that characterises the time series, more specifically the behaviour of the variable of interest as a specific function of time (as the global temperature time series seen earlier). Let us consider another example of time series based on real data, i.e. the quarterly earnings of Johnson &amp; Johnson between 1960 and 1980 represented below.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>As can be seen from the plot, the earnings appear to grow over time, therefore we can imagine fitting a line to this data to describe its behaviour (see red line below).</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Although the line captures a part of the behaviour, it is quite clear that the trend of the time series is not linear. It could therefore be more appropriate to define another function of time to describe it and, consequently, we add a quadratic term of time to obtain the following fit.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>We can see now that the quadratic function of time allows to better fit the observed time series and closely follow the observations. However, there still appears to be a pattern in the data that isn’t captured by this quadratic model. This pattern appears to be repeated over time: peaks and valleys that seem to occur at regular intervals along the time series. This behaviour is known as <em>seasonality</em> which, in this case, can be explained by the effect of a specific quarter on the behaviour of the earnings. Indeed, it is reasonable to assume that the seasons have impacts on different variables measured over time (e.g. temperatures, earnings linked to sales that vary with seasons, etc.). Let us therefore take the quarters as an explanatory variable and add it to the previous quadratic model (see fit below).</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>This final fit appears to well describe the behaviour of the earnings. Hence, <em>trend</em> and <em>seasonality</em> are the main features that characterize the deterministic component of a time series. However, as discussed earlier, these deterministic components often don’t explain all of the observed time series since there is often a random component characterizing data measured over time. Not considering the latter component can have considerable impacts on the inference procedures (as seen earlier) and it is therefore important to adequately analyse them (see next section).</p>
</div>
<div id="the-random-component-noise" class="section level3">
<h3><span class="header-section-number">2.2.2</span> The random component (Noise)</h3>
<p>From this section onwards we will refer to <em>time series as being solely the random noise component</em>. Keeping this in mind, a <em>time series</em> is a particular kind of <em>stochastic process</em> which, generally speaking, is a collection of random variables indexed by a set of numbers. Not surprisingly, the index of reference for a time series is given by <em>time</em> and, consequently, a time series is a collection of random variables indexed (or “measured”) over time such as, for example, the daily price of a financial asset or the monthly average temperature in a given location. In terms of notation, a time series is often represented as</p>
<p><span class="math display">\[\left(X_1, X_2, ..., X_n \right) \;\;\; \text{ or } \;\;\; \left(X_t\right)_{t = 1,...,n}.\]</span></p>
<p>The time index <span class="math inline">\(t\)</span> is contained within either the set of reals, <span class="math inline">\(\mathbb{R}\)</span>, or
integers, <span class="math inline">\(\mathbb{N}\)</span>. When <span class="math inline">\(t \in \mathbb{R}\)</span>, the time series becomes a
<em>continuous-time</em> stochastic process such a Brownian motion, a model used to
represent the random movement of particles within a suspended liquid or gas. However, within this book, we will limit ourselves to the cases where <span class="math inline">\(t \in \mathbb{N}\)</span>, better known as <em>discrete-time</em> processes. <em>Discrete-time</em> processes are measured sequentially at fixed
and equally spaced intervals in time. This implies that we will uphold two general assumptions for the time series considered in this book:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(t\)</span> is not random, e.g. the time at which each observation is measured is known, and</li>
<li>the time between two consecutive observations is constant.</li>
</ol>
<p>This book will also focus on certain representations of time series based on parametric probabilistic models. For example, one of the fundamental probability models used in time series analysis is called the <em>white noise</em> model and is defined as</p>
<p><span class="math display">\[X_t \mathop \sim \limits^{iid} N(0, \sigma^2).\]</span></p>
<p>This statement simply means that <span class="math inline">\((X_t)\)</span> is normally distributed and independent over time. Ideally, this is the type of process that we would want to observe once we have performed a statistical modelling procedure. However, despite it appearing to be an excessively simple model to be considered for time series, it is actually a crucial component to construct a wide range of more complex time series models (see Chapter 2). Indeed, unlike the white noise process, time series are typically <em>not</em> independent over time. For example, if we suppose that the temperature in State College is unusually low on a given dat, then it is reasonable to assume that temperature the day after will also be low.</p>
<p>With this in mind, let us now give a quick overview of the information that can be retrieved on a time series from a simple descriptive representation.</p>
<div id="eda" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> Exploratory Data Analysis for Time Series</h4>
<p>When dealing with relatively small time series (e.g. a few thousands), it is
often useful to look at a graph of the original data. A graph can be
an informative tool for “detecting” some features of a time series such as trends and
the presence of outliers. This is indeed what was done in the previous paragraphs when analysing the global temperature data or the Johnson &amp; Johnson data.</p>
<p>To go more in depth with respect to the previous paragraphs, a trend is typically assumed to be present in a time series when the data exhibit some form of long term increase or decrease or combination of increases or decreases. Such trends could be linear or non-linear and represent
an important part of the “signal” of a model (as seen for the Johnson &amp; Johnson time series). Here are a few examples of
non-linear trends:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Seasonal trends</strong> (periodic): These are the cyclical patterns which repeat
after a fixed/regular time period. This could be due to business cycles
(e.g. bust/recession, recovery).</p></li>
<li><p><strong>Non-seasonal trends</strong> (periodic): These patterns cannot be associated to
seasonal variation and can for example be due to an external variable such as,
for example, the impact of economic indicators on stock returns. Note that such
trends are often hard to detect based on a graphical analysis of the data.</p></li>
<li><p><strong>“Other” trends</strong>: These trends have typically no regular patterns and are
over a segment of time, known as a “window”, that change the statistical
properties of a time series. A common example of such trends is given by the
vibrations observed before, during and after an earthquake.</p></li>
</ol>
<p>Moreover, when observing “raw” time series data it is also interesting to
evaluate if some of the following phenomena occur:</p>
<ol style="list-style-type: decimal">
<li><strong>Change in Mean:</strong> Does the mean of the process shift over time?</li>
<li><strong>Change in Variance:</strong> Does the variance of the process evolve with time?</li>
<li><strong>Change in State:</strong> Does the time series appear to change between “states”
having distinct statistical properties?</li>
<li><strong>Outliers</strong> Does the time series contain some “extreme” observations?
(Note that this is typically difficult to assess visually.)</li>
</ol>

<div class="example">
<span id="exm:earthquake" class="example"><strong>Example 2.1  </strong></span>In the figure below, we present an example of displacement recorded
during an earthquake as well as an explosion.
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(EQ5, <span class="dt">package =</span> <span class="st">&quot;astsa&quot;</span>)
<span class="kw">data</span>(EXP6, <span class="dt">package =</span> <span class="st">&quot;astsa&quot;</span>)

<span class="co"># Construct gts object</span>
eq5 &lt;-<span class="st"> </span><span class="kw">gts</span>(EQ5, <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">freq =</span> <span class="dv">1</span>, <span class="dt">unit_ts =</span> <span class="st">&quot;p/s&quot;</span>, <span class="dt">name_ts =</span> <span class="st">&quot;Earthquake Arrival Phases&quot;</span>, <span class="dt">data_name =</span> <span class="st">&quot;Earthquake Arrival Phases&quot;</span>)
exp6 &lt;-<span class="st"> </span><span class="kw">gts</span>(EXP6, <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">freq =</span> <span class="dv">1</span>, <span class="dt">unit_ts =</span> <span class="st">&quot;p/s&quot;</span>, <span class="dt">name_ts =</span> <span class="st">&quot;Explosion Arrival Phases&quot;</span>, <span class="dt">data_name =</span> <span class="st">&quot;Explosion Arrival Phases&quot;</span>)

<span class="co"># Plot time series</span>
<span class="kw">plot</span>(eq5)</code></pre>
<p><img src="bookdown-demo_files/figure-html/example_EQ-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(exp6)</code></pre>
<p><img src="bookdown-demo_files/figure-html/example_EQ-2.png" width="672" /></p>
<p>From the graph, it can be observed that the statistical properties of the time
series appear to change over time. For instance, the variance of the time series
shifts at around <span class="math inline">\(t = 1150\)</span> for both series.
The shift in variance also opens “windows” where there appear to be distinct
states. In the case of the explosion data, this is particularly relevant around
<span class="math inline">\(t = 50, \cdots, 250\)</span> and then again from <span class="math inline">\(t = 1200, \cdots, 1500\)</span>. Even within
these windows, there are “spikes” that could be considered as outliers most
notably around <span class="math inline">\(t = 1200\)</span> in the explosion series.</p>
<p>Extreme observations or outliers are commonly observed in real time series data, this is illustrated in the following example.</p>

<div class="example">
<span id="exm:precipitation" class="example"><strong>Example 2.2  </strong></span>We consider here a data set coming from the domain of hydrology. The data
concerns monthly precipitation (in mm) over a certain period of time (1907 to
1972) and is interesting for scientists in order to study water cycles. The
data are presented in the graph below:
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load hydro dataset</span>
<span class="kw">data</span>(<span class="st">&quot;hydro&quot;</span>)

<span class="co"># Simulate based on data</span>
hydro =<span class="st"> </span><span class="kw">gts</span>(<span class="kw">as.vector</span>(hydro), <span class="dt">start =</span> <span class="dv">1907</span>, <span class="dt">freq =</span> <span class="dv">12</span>, <span class="dt">unit_ts =</span> <span class="st">&quot;in.&quot;</span>, 
            <span class="dt">name_ts =</span> <span class="st">&quot;Precipitation&quot;</span>, <span class="dt">data_name =</span> <span class="st">&quot;Hydrology data&quot;</span>)

<span class="co"># Plot hydro </span>
<span class="kw">plot</span>(hydro)</code></pre>
<p><img src="bookdown-demo_files/figure-html/example_hydro-1.png" width="672" /></p>
<p>Next, we consider an example coming from high-frequency finance to illustrate
the limitations our current framework.</p>
<p>The figure below presents the returns or price innovations
(i.e. the changes in price from one observation to the
next) for Starbuck’s stock on July 1, 2011 for about 150 seconds (left
panel) and about 400 minutes (right panel).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># TO DO add Duke&#39;s code here!</span></code></pre>
<p>It can be observed on the left panel that observations are not equally spaced.
Indeed, in high-frequency data the intervals between two points are typically not
constant and are, even worse, random variables. This implies that the time when
a new observation will be available is in general unknown. On the right panel,
one can observe that the variability of the data seems to change during the
course of the trading day. Such a phenomenon is well known in the finance
community since a lot of variation occurs at the start (and the end) of the
day while the middle of the day is associated with small changes.
Moreover, clear extreme observations can also be noted in this graph at
around 11:00.</p>
<p>Finally, let us consider the limitations of a direct graphical representation of
a time series when the sample size is large. Indeed, due to visual limitations,
a direct plotting of the data will probably result in an uninformative
aggregation of points between which it is unable to distinguish anything. This is
illustrated in the following example.</p>
<p>We consider here the data coming from the calibration procedure of
an Inertial Measurement Unit (IMU) which, in general terms, is used to enhance
navigation precision or reconstruct three dimensional movements:</p>
<iframe src="https://www.youtube.com/watch?v=htoBvSq8jLA" width="672" height="400px">
</iframe>
<p>These sensors are used in a very wide range of applications such as robotics, virtual reality,
vehicle stability control, human and animal motion capture and so forth:</p>
<iframe src="https://www.youtube.com/watch?v=g4tgtPA54_Y" width="672" height="400px">
</iframe>
<p>The signals coming from these instruments are measured at
high frequencies over a long time and are often characterized by linear trends
and numerous underlying stochastic processes.</p>
<p>The code below retrieves some data from an IMU and plots it directly:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load IMU data</span>
<span class="kw">data</span>(imu6, <span class="dt">package =</span> <span class="st">&quot;imudata&quot;</span>)

<span class="co"># Construct gst object</span>
Xt =<span class="st"> </span><span class="kw">gts</span>(imu6[,<span class="dv">1</span>], <span class="dt">data_name =</span> <span class="st">&quot;Gyroscope data&quot;</span>, <span class="dt">unit_time =</span> <span class="st">&quot;hour&quot;</span>, 
         <span class="dt">freq =</span> <span class="dv">100</span><span class="op">*</span><span class="dv">60</span><span class="op">*</span><span class="dv">60</span>, <span class="dt">name_ts =</span> <span class="st">&quot;Angular rate&quot;</span>, 
         <span class="dt">unit_ts =</span> <span class="kw">bquote</span>(rad<span class="op">^</span><span class="dv">2</span><span class="op">/</span>s<span class="op">^</span><span class="dv">2</span>))

<span class="co"># Plot time series</span>
<span class="kw">plot</span>(Xt)</code></pre>
<p><img src="bookdown-demo_files/figure-html/example_IMU-1.png" width="672" /></p>
<p>Although a linear trend and other processes are present in this signal
(time series), it is practically impossible to understand or guess anything
from the plot.</p>
<p>Having discussed these representations (and the relative issues with these representations) let us present the basic parametric models that are used to build even more complex models to describe and predict the behaviour of a time series.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fzb.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basicmodels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-intro.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
