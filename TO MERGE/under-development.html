<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#under-development"><i class="fa fa-check"></i><b>1</b> Under development</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#autoregressive-moving-average-models"><i class="fa fa-check"></i><b>1.1</b> Autoregressive Moving Average Models ⚠️</a><ul>
<li class="chapter" data-level="1.1.1" data-path=""><a href="#acfpacf"><i class="fa fa-check"></i><b>1.1.1</b> ACF/PACF</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#arima"><i class="fa fa-check"></i><b>1.2</b> ARIMA</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#sarima"><i class="fa fa-check"></i><b>1.3</b> SARIMA</a><ul>
<li class="chapter" data-level="1.3.1" data-path=""><a href="#real-data-example"><i class="fa fa-check"></i><b>1.3.1</b> Real data example</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="under-development" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Under development</h1>
<div id="autoregressive-moving-average-models" class="section level2">
<h2><span class="header-section-number">1.1</span> Autoregressive Moving Average Models ⚠️</h2>
<p>The classes of time series models discussed this far (i.e. AR(<span class="math inline">\(p\)</span>) and MA(<span class="math inline">\(q\)</span>) models) are both classes that address different forms of dependence between observations over time. The class of AR(<span class="math inline">\(p\)</span>) models describes the direct (and indirect) linear dependence between observations over time while MA(<span class="math inline">\(q\)</span>) models describe the dependence in the innovation processes rather than the observations themselves. Separately, these classes of models therefore allow to take into account two extremely common dependence settings within time series. In this section however we present a class of models that combines the features of these two classes and are called ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models. These are defined as follows.</p>

<div class="definition">
<span id="def:defARMA" class="definition"><strong>Definition 1.1  (ARMA models)  </strong></span>A process <span class="math inline">\((X_{t})\)</span> is an ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) process if <span class="math inline">\((X_t)\)</span> (or <span class="math inline">\((X_{t}-\mathbb{E}[X_{t}])\)</span>) satisfies the linear difference equation <span class="math display">\[X_{t} = \phi_{1}X_{t-1} + \cdots + \phi_{p}X_{t-p} + W_{t}+\theta_{1}W_{t-1}+ \cdots+\theta_{q}W_{t-q},\]</span> where <span class="math inline">\(W_{t}\sim \mathcal{N}(0,\sigma_{w}^2)\)</span>. An ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) can be written in concise form as: $( B ) <span class="math display">\[X_t = \theta \left( B \right)W_t, \]</span> where <span class="math inline">\(\phi(B)\)</span> and <span class="math inline">\(\theta(B)\)</span> are the AR and MA polynomials (operators): <span class="math display">\[\phi(B)=1-\phi_{1}B-\cdots-\phi_{p}B^p \]</span> <span class="math display">\[\theta(B)=1+\theta_{1}B+\cdots+\theta_{q}B^q. \]</span>
</div>
<p> <br></p>
<p>Based on this definition, we can see how ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models allow to take into account the two forms of dependence of the previous classes of models and generalize them. Indeed, if we fix <span class="math inline">\(q = 0\)</span>, an ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) model simply becomes an AR(<span class="math inline">\(p\)</span>) model while, on the contrary, if we fix <span class="math inline">\(p = 0\)</span> these models become MA(<span class="math inline">\(q\)</span>) models. Hence, the class of ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models is an extremely flexible class which inherits the properties (and constraints) of the two classes of models discussed this far.</p>

<div class="example">
<span id="exm:unnamed-chunk-2" class="example"><strong>Example 1.1  (Causality and Invertibility of ARMA(p,q) models)  </strong></span>One of the main properties that ARMA models inherit from the classes of AR(p) and MA(q) models are the conditions required for these models to be stationary and for their parameters to be identifiable. Indeed, we saw that AR(p) models need to respect the condition of <em>causality</em> (since they are always invertible) while MA(q) models need to respect the condition of <em>invertibility</em> (since they are always causal).
</div>

<p>Given these conditions, we can now define the conditions for the ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models we are going to consider in this section.</p>

<div class="definition">
<p><span id="def:unnamed-chunk-3" class="definition"><strong>Definition 1.2  (Causal and Invertible ARMA(p,q) models)  </strong></span>An ARMA model is causal and invertible if:</p>
<ul>
<li>the AR(<span class="math inline">\(p\)</span>) part is causal, and</li>
<li>the MA(<span class="math inline">\(q\)</span>) part is invertible
</div>
</li>
</ul>
<p>If the above conditions are respected, then we are sure to be working with ARMA models that are stationary and whose parameters can be uniquely identified. This is a direct consequence of the separate properties and conditions for AR(<span class="math inline">\(p\)</span>) models, on one side, and MA(<span class="math inline">\(q\)</span>) models, on the other side. However, there are additional “constraints” that need to be considered given the wider class of dependence that ARMA models can take into account. Indeed, with the copresence of AR(<span class="math inline">\(p\)</span>) and MA(<span class="math inline">\(q\)</span>) models can lead to the definition of ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) models that can be re-expressed as another ARMA(<span class="math inline">\(p*\)</span>,<span class="math inline">\(q*\)</span>) model where <span class="math inline">\(p \leq p*\)</span> and/or <span class="math inline">\(q \leq q*\)</span>. Remember that the identifiability issue for MA(<span class="math inline">\(q\)</span>) models exists only for models with the same order <span class="math inline">\(q\)</span> so this is a different setting. This issue for ARMA models is called “parameter redundancy”.</p>

<div class="example">
<span id="exm:redunARMA" class="example"><strong>Example 1.2  (Parameter Redundancy of ARMA models)  </strong></span>Let us consider the ARMA(1,1) process:
<span class="math display">\[\begin{align*}
            X_t - 0.9 X_{t-1} &amp;= W_t - 0.9 W_{t-1}.
        \end{align*}\]</span>
Using the polynomial operators defined earlier, this model can be :
<span class="math display">\[\begin{equation*}
            X_t - 0.9 X_{t-1} = W_t - 0.9 W_t \Longleftrightarrow (1 - 0.9B) X_t = (1 - 0.9 B) W_t.
        \end{equation*}\]</span>
<p>Based on the expression above, we can see that both sides of the ARMA equation share a common term which is <span class="math inline">\((1 - 0.9B)\)</span> which therefore can be simplified thereby defining the mode <span class="math display">\[X_t = W_t.\]</span></p>
Hence, the specified ARMA(1,1) model is actually a white noise mode.
</div>

<p>In general, if a model has autoregressive and moving average operators that share a common root, then the model has <strong>redundant parameters</strong> and can consistute an “over-parametrization” of the problem. Let us further explore this problem through another example.</p>

<div class="example">
<span id="exm:redunARMA2" class="example"><strong>Example 1.3  (Parameter Redundancy of ARMA models)  </strong></span>Consider the following model:
<span class="math display">\[\begin{equation*}
            X_t = 0.3 X_{t-1} + 0.1 X_{t-2} + W_t + W_{t-1} + 0.16 W_{t-2},
        \end{equation*}\]</span>
which is an ARMA(2,2). By rearranging the terms, we can do the following calculations
<span class="math display">\[\begin{equation*}
            \begin{aligned} 
                 X_t - 0.3 X_{t-1} - 0.1 X_{t-2} &amp;= W_t + W_{t-1} + 0.16 W_{t-2}\\
                 (1 - 0.3 B - 0.1 B^2 ) X_t  &amp;= (1 + B + 0.16B^2) W_t\\
                 (1 + 0.2B)(1 - 0.5 B) X_t  &amp;= (1 + 0.2B)(1 + 0.8 B) W_t\\
                (1 - 0.5 B) X_t  &amp;= (1 + 0.8 B) W_t\\
                 X_t  &amp;= 0.5 X_{t-1} + W_t - 0.8 W_{t-1}.
            \end{aligned}
        \end{equation*}\]</span>
Therefore, the initial ARMA(2,2) model is in fact an <strong>ARMA(1,1)</strong> model. Note that the latter model is causal (as <span class="math inline">\(|\phi|&lt;1\)</span>) and invertible (as <span class="math inline">\(|\theta| &lt; 1\)</span>) and therefore respects the conditions we highlighted at the beginning of this section.
</div>

<div id="acfpacf" class="section level3">
<h3><span class="header-section-number">1.1.1</span> ACF/PACF</h3>
<ul>
<li>Derivation the ACF/PACF of ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>) is generally difficult. : Given an ARMA(1,1), we have <span class="math inline">\(\rho(h) = \phi^{h-1} \rho(1)\)</span> where</li>
</ul>
<span class="math display">\[\begin{equation*}
                \rho(1) = \frac{\left(1+\theta \phi \right)\left(\theta + \phi\right)}{1+2\phi\theta+\theta^2}.
\end{equation*}\]</span>
<ul>
<li>It is difficult to identify ARMA process from their ACF/PACF. Indeed, we have:</li>
</ul>
<table style="width:86%;">
<caption>(#acfpacf) Caption here</caption>
<colgroup>
<col width="19%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">AR(<span class="math inline">\(p\)</span>)</th>
<th align="center">MA(<span class="math inline">\(q\)</span>)</th>
<th align="right">ARMA(<span class="math inline">\(p\)</span>,<span class="math inline">\(q\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ACF</td>
<td align="center">Tails off</td>
<td align="center">Cuts off after lag <span class="math inline">\(q\)</span></td>
<td align="right">Tails off</td>
</tr>
<tr class="even">
<td>PACF</td>
<td align="center">Cuts off after lag <span class="math inline">\(p\)</span></td>
<td align="center">Tails off</td>
<td align="right">Tails off</td>
</tr>
</tbody>
</table>
<p>As an example let us consider the following two ARMA(<span class="math inline">\(q\)</span>) models:</p>
<p><span class="math display">\[
\begin{aligned}
X_t &amp;= 0.3 X_{t-1} - 0.8 X_{t-2} +  0.7 W_{t-1} + W_t \\
Y_t &amp;= 1.2 X_{t-1} - 0.25 X_{t-2} - 0.1 W_{t-1} - 0.75 W_{t-2} + W_t, \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(W_t \overset{iid}{\sim} \mathcal{N}(0, 1)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Xt =<span class="st"> </span><span class="kw">gen_gts</span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="kw">ARMA</span>(<span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.8</span>), <span class="dt">ma =</span> <span class="fl">0.7</span>, <span class="dt">sigma2 =</span> <span class="dv">1</span>))
Yt =<span class="st"> </span><span class="kw">gen_gts</span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="kw">ARMA</span>(<span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.25</span>), 
             <span class="dt">ma =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.75</span>), <span class="dt">sigma2 =</span> <span class="dv">1</span>))
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(Xt, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Simulated process: &quot;</span><span class="op">*</span><span class="st"> </span>X[t] <span class="op">*</span><span class="st">&quot; with &quot;</span><span class="op">*</span><span class="st"> </span>T <span class="op">*</span><span class="st">&quot; = 500&quot;</span>))
<span class="kw">plot</span>(Yt, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Simulated process: &quot;</span><span class="op">*</span><span class="st"> </span>Y[t] <span class="op">*</span><span class="st">&quot; with &quot;</span><span class="op">*</span><span class="st"> </span>T <span class="op">*</span><span class="st">&quot; = 500&quot;</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-4-1.png" alt="TO DO" width="768" />
<p class="caption">
Figure 1.1: TO DO
</p>
</div>
<p>The theoretical ACF/PACF</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(<span class="kw">theo_acf</span>(<span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.8</span>), <span class="dt">ma =</span> <span class="fl">0.7</span>), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Theo. ACF - MA(1); &quot;</span><span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st">&quot; = 0.9&quot;</span>))
<span class="kw">plot</span>(<span class="kw">theo_pacf</span>(<span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.8</span>), <span class="dt">ma =</span> <span class="fl">0.7</span>), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Theo. PACF - MA(1); &quot;</span><span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st">&quot; = 0.9&quot;</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-5-1.png" alt="TO DO" width="768" />
<p class="caption">
Figure 1.2: TO DO
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(<span class="kw">theo_acf</span>(<span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.25</span>), <span class="dt">ma =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.75</span>)), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Theo. ACF - MA(1); &quot;</span><span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st">&quot; = 0.9&quot;</span>))
<span class="kw">plot</span>(<span class="kw">theo_pacf</span>(<span class="dt">ar =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.25</span>), <span class="dt">ma =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.75</span>)), <span class="dt">main =</span> <span class="kw">expression</span>(<span class="st">&quot;Theo. ACF - MA(1); &quot;</span><span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st">&quot; = -0.9&quot;</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-6-1.png" alt="TO DO" width="768" />
<p class="caption">
Figure 1.3: TO DO
</p>
</div>
<p>Remark on the identification of the order of an ARMA model:</p>
<ul>
<li>ACF and PACF of ARMA models are difficult to interpret.</li>
<li>It is generally easier to consider a list of candidate models and selected the ``best’’ model in this list using a model selection criterion or an estimator of the prediction error (e.g. MAPE).</li>
<li>Check diagnostic plot to assess if the model is reasonable for this time series.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Xt =<span class="st"> </span><span class="kw">gts</span>(<span class="kw">as.numeric</span>(<span class="kw">dmseries</span>(<span class="st">&quot;https://datamarket.com/data/set/22y1/annual-copper-prices-1800-1997#!ds=22y1&amp;display=line&quot;</span>)),
    <span class="dt">start =</span> <span class="dv">1921</span>, <span class="dt">freq =</span> <span class="dv">12</span>, <span class="dt">name_ts =</span> <span class="st">&quot;Copper prices (minus the long-term trend)&quot;</span>,
    <span class="dt">data_name =</span> <span class="st">&quot;Copper Price&quot;</span>, <span class="dt">name_time =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">plot</span>(Xt)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-7-1.png" alt="TO DO" width="672" />
<p class="caption">
Figure 1.4: TO DO
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corr_analysis</span>(Xt)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-8-1.png" alt="Empirical ACF (left) and PACF (right) of the Copper time series data." width="768" />
<p class="caption">
Figure 1.5: Empirical ACF (left) and PACF (right) of the Copper time series data.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(<span class="kw">ARMA</span>(<span class="dv">4</span>,<span class="dv">5</span>), Xt)</code></pre></div>
<pre><code>## Warning in arima(xt, order = ., include.mean = include.mean): possible
## convergence problem: optim gave code = 1

## Warning in arima(xt, order = ., include.mean = include.mean): possible
## convergence problem: optim gave code = 1</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-9-1.png" alt="Empirical ACF (left) and PACF (right) of the Copper time series data." width="768" />
<p class="caption">
Figure 1.6: Empirical ACF (left) and PACF (right) of the Copper time series data.
</p>
</div>
<pre><code>## 
## Call:
## arima(x = xt, order = c(3, 0, 5), include.mean = include.mean)
## 
## Coefficients:
##           ar1     ar2     ar3     ma1     ma2      ma3      ma4      ma5
##       -0.4939  0.3748  0.8625  1.4987  0.7951  -0.4955  -0.5172  -0.2575
## s.e.   0.0531  0.0635  0.0519  0.1301  0.2081   0.1869   0.1638   0.0862
##       intercept
##          0.1406
## s.e.     0.3949
## 
## sigma^2 estimated as 0.5441:  log likelihood = -223.08,  aic = 466.15</code></pre>
<p>To decide:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">evaluate</span>(<span class="kw">list</span>(<span class="kw">AR</span>(<span class="dv">1</span>), <span class="kw">ARMA</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="kw">ARMA</span>(<span class="dv">3</span>, <span class="dv">5</span>)), Xt, <span class="dt">criterion =</span> <span class="st">&quot;MAPE&quot;</span>, <span class="dt">start =</span> <span class="fl">0.5</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_copper =<span class="st"> </span><span class="kw">estimate</span>(<span class="kw">ARMA</span>(<span class="dv">3</span>,<span class="dv">2</span>), Xt)
<span class="kw">check</span>(model_copper)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-11-1.png" alt="Diagnostic plots for the residuals of a TO DO" width="672" />
<p class="caption">
Figure 1.7: Diagnostic plots for the residuals of a TO DO
</p>
</div>
</div>
</div>
<div id="arima" class="section level2">
<h2><span class="header-section-number">1.2</span> ARIMA</h2>
</div>
<div id="sarima" class="section level2">
<h2><span class="header-section-number">1.3</span> SARIMA</h2>
<div id="real-data-example" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Real data example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Xt =<span class="st"> </span><span class="kw">gts</span>(<span class="kw">as.numeric</span>(<span class="kw">dmseries</span>(<span class="st">&quot;https://datamarket.com/data/set/22pw/monthly-lake-erie-levels-1921-1970#!ds=22pw&amp;display=line&quot;</span>)),
    <span class="dt">start =</span> <span class="dv">1921</span>, <span class="dt">freq =</span> <span class="dv">12</span>, <span class="dt">name_ts =</span> <span class="st">&quot;Water Levels&quot;</span>,
    <span class="dt">data_name =</span> <span class="st">&quot;Monthly Lake Erie Levels&quot;</span>, <span class="dt">name_time =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">plot</span>(Xt)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-12-1.png" alt="TO DO" width="672" />
<p class="caption">
Figure 1.8: TO DO
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corr_analysis</span>(Xt)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-13-1.png" alt="Empirical ACF (left) and PACF (right) of the Lake Erie time series data." width="768" />
<p class="caption">
Figure 1.9: Empirical ACF (left) and PACF (right) of the Lake Erie time series data.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Xt =<span class="st"> </span><span class="kw">gts</span>(<span class="kw">as.numeric</span>(<span class="kw">dmseries</span>(<span class="st">&quot;https://datamarket.com/data/set/235j/number-of-daily-births-in-quebec-jan-01-1977-to-dec-31-1990#!ds=235j&amp;display=line&quot;</span>)),
    <span class="dt">start =</span> <span class="dv">1977</span>, <span class="dt">freq =</span> <span class="dv">365</span>, <span class="dt">name_ts =</span> <span class="st">&quot;Number of Births&quot;</span>,
    <span class="dt">data_name =</span> <span class="st">&quot;Number of Births in Quebec&quot;</span>, <span class="dt">name_time =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">plot</span>(Xt)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-14-1.png" alt="TO DO" width="672" />
<p class="caption">
Figure 1.10: TO DO
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corr_analysis</span>(Xt, <span class="dt">lag.max =</span> <span class="dv">50</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="04-sdfn_files/figure-html/unnamed-chunk-15-1.png" alt="Empirical ACF (left) and PACF (right) of the Births time series data." width="768" />
<p class="caption">
Figure 1.11: Empirical ACF (left) and PACF (right) of the Births time series data.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod =<span class="st"> </span><span class="kw">estimate</span>(<span class="kw">SARIMA</span>(<span class="dt">ar =</span> <span class="dv">2</span>, <span class="dt">ma =</span> <span class="dv">1</span>, <span class="dt">sar =</span> <span class="dv">2</span>, <span class="dt">sma =</span> <span class="dv">1</span>, <span class="dt">s =</span> <span class="dv">7</span>, <span class="dt">si =</span> <span class="dv">1</span>), Xt, <span class="dt">method =</span> <span class="st">&quot;mle&quot;</span>)
<span class="kw">check</span>(mod)</code></pre></div>
<p><img src="04-sdfn_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(mod, <span class="dt">n.ahead =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="04-sdfn_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/%s",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
